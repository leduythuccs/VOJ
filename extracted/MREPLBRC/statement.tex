Dãy ngoặc hợp lệ gồm:
\begin{itemize}
	\item Xâu rỗng.
	\item A hợp lệ thì (A), [A] và \{A\} cũng thế.
	\item A, B hợp lệ thì AB cũng thế.
\end{itemize}

Ví dụ : [(\{\})], []()\{\} và [\{\}]()[\{\}] là hợp lệ, [(\{\{([, [](\{)\} và [\{\}])([\{\}] không hợp lệ.

Cho một xâu chỉ gồm ( ) \{ \} [ ] và ?. Dấu ? có thể thay thế bằng ngoặc bất kỳ. Tính số cách thay thế mà thu được 1 dẫy ngoặc hợp lệ. Chỉ hiện 5 chữ số cuối cùng.

\