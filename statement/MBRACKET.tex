

Xét dãy ngoặc chỉ gồm các ngoặc vuông và tròn - '( ) [ ]'.

Dãy ngoặc hợp lệ là :
\begin{enumerate}
	\item '( )' , '[ ]' : hợp lệ.
	\item A hợp lệ thì (A) và [A] hợp lệ.
	\item A, B hợp lệ thì AB hợp lệ.
\end{enumerate}

Ví dụ : '( ) ( ) [ ]', '( [ ] ) [ ( ) ]' và '[ ( ( ) ) ] [ ]' hợp lệ. Còn '(', '] [', '[ ( ]' and '( [ ) ]' không hợp lệ.

Cho 1 dãy ngoặc. Ở mỗi bước chèn thêm ngoặc vuông hoặc tròn vào đầu hoặc cuối. Với mỗi bước tính độ dài dãy ngoặc hợp lệ ngắn nhất gồm các ngoặc liên tiếp nhau mà chứa ngoặc mới được thêm vào.

\subsubsection{Input}

Dòng đầu là dãy ngoặc ban đầu, độ dài  $\le$  100,000. Dòng tiếp theo là số nguyên N, 1 ≤ N ≤ 100,000, số thao tác.





N dòng tiếp theo, mỗi dòng gồm số nguyên A và kí tự C.


A = 0 thì C được chèn vào đầu xâu.


A = 1 thì C được chèn vào cuối xâu.

\subsubsection{Output}

Với mỗi bước i,1  $\le$  i  $\le$  N, ghi độ dài ngắn nhất tìm được trên 1 dòng.

\subsubsection{Sample}
\begin{verbatim}
input 
[]) 
3 
0 ) 
0 ( 
0 ( 
output 
0 
2 
6 

input 
(] 
3 
1 ) 
0 ) 
0 ( 
output 
0 
0 
2 
\end{verbatim}

 
